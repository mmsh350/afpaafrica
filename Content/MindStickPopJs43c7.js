(function(n){n.Mindstick_Dialog=function(t,i){var h={animation_speed:250,auto_close:!1,buttons:!0,custom_class:!1,keyboard:0,message:"",modal:!0,overlay_close:0,overlay_opacity:.9,position:"center",title:"",type:"information",vcenter_short_message:!0,width:0,onClose:null,background:""},r=this;r.settings={};options={};"string"==typeof t&&(options.message=t);("object"==typeof t||"object"==typeof i)&&(options=n.extend(options,"object"==typeof t?t:i));r.init=function(){var t,i;if(r.settings=n.extend({},h,options),r.isIE6=n.browser.msie&&parseInt(n.browser.version,10)==6||!1,r.settings.modal&&(r.overlay=jQuery("<div>",{"class":"MindstickDialogOverlay"}).css({position:r.isIE6?"absolute":"fixed",left:0,top:0,opacity:r.settings.overlay_opacity,"z-index":1e3}),r.settings.overlay_close&&r.overlay.bind("click",function(){r.close()}),r.overlay.appendTo("body")),r.dialog=jQuery("<div>",{"class":"MindstickDialog"+(r.settings.custom_class?" "+r.settings.custom_class:"")}).css({position:r.isIE6?"absolute":"fixed",left:0,top:0,"z-index":999999,visibility:"hidden",background:""}),!r.settings.buttons&&r.settings.auto_close&&r.dialog.attr("id","MindstickDialog_"+Math.floor(Math.random()*9999999)),t=parseInt(r.settings.width),!isNaN(t)&&t==r.settings.width&&t.toString()==r.settings.width.toString()&&t>0&&r.dialog.css({width:r.settings.width}),r.settings.title&&jQuery("<h3>",{"class":"MindstickDialog_Title"}).html(r.settings.title).appendTo(r.dialog),r.message=jQuery("<div>",{"class":"MindstickDialog_Body"+(e()!=""?" MindstickDialog_Icon MindstickDialog_"+e():"")}),r.settings.vcenter_short_message?jQuery("<div>").html(r.settings.message).appendTo(r.message):r.message.html(r.settings.message),r.message.appendTo(r.dialog),r.settings.buttons===!0||n.isArray(r.settings.buttons)){if(r.settings.buttons===!0)switch(r.settings.type){case"question":r.settings.buttons=["Yes","No"];break;default:r.settings.buttons=["Ok"]}t=r.settings.buttons.reverse()}else t=!1;return t&&(i=jQuery("<div>",{"class":"MindstickDialog_Buttons"}).appendTo(r.dialog),n.each(t,function(t,u){var f=jQuery("<a>",{href:"javascript:void(0)","class":"MindstickDialog_Button"+t});n.isPlainObject(u)?f.html(u.caption):f.html(u);f.bind("click",function(){void 0!=u.callback&&u.callback(r.dialog);r.close(void 0!=u.caption?u.caption:u)});f.appendTo(i)}),jQuery("<div>",{style:"clear:both"}).appendTo(i)),r.dialog.appendTo("body"),n(window).bind("resize",u),r.settings.keyboard&&n(document).bind("keyup",o),r.isIE6&&n(window).bind("scroll",s),r.settings.auto_close!==!1&&(r.dialog.bind("click",function(){clearTimeout(r.timeout);r.close()}),r.timeout=setTimeout(r.close,r.settings.auto_close)),u(),r};r.close=function(t){r.settings.keyboard&&n(document).unbind("keyup",o);r.isIE6&&n(window).unbind("scroll",s);n(window).unbind("resize",u);r.overlay&&r.overlay.animate({opacity:0},r.settings.animation_speed,function(){r.overlay.remove()});r.dialog.animate({top:0,opacity:0},r.settings.animation_speed,function(){if(r.dialog.remove(),r.settings.onClose&&typeof r.settings.onClose=="function")r.settings.onClose(void 0!=t?t:"")})};var u=function(){var i=n(window).width(),u=n(window).height(),t=r.dialog.width(),e=r.dialog.height(),t={left:0,top:0,right:i-t,bottom:u-e,center:(i-t)/2,middle:(u-e)/2};r.dialog_left=void 0;r.dialog_top=void 0;r.settings.modal&&r.overlay.css({width:i,height:u});n.isArray(r.settings.position)&&r.settings.position.length==2&&typeof r.settings.position[0]=="string"&&r.settings.position[0].match(/^(left|right|center)[\s0-9\+\-]*$/)&&typeof r.settings.position[1]=="string"&&r.settings.position[1].match(/^(top|bottom|middle)[\s0-9\+\-]*$/)&&(r.settings.position[0]=r.settings.position[0].toLowerCase(),r.settings.position[1]=r.settings.position[1].toLowerCase(),n.each(t,function(b,c){for(var e,d=0;d<2;d++)e=r.settings.position[d].replace(b,c),e!=r.settings.position[d]&&(d==0?r.dialog_left=eval(e):r.dialog_top=eval(e))}));(void 0==r.dialog_left||void 0==r.dialog_top)&&(r.dialog_left=t.center,r.dialog_top=t.middle);r.settings.vcenter_short_message&&(i=r.message.find("div:first"),u=i.height(),t=r.message.height(),u<t&&i.css({"margin-top":(t-u)/2}));r.dialog.css({left:r.dialog_left,top:r.dialog_top,visibility:"visible"});r.dialog.find("a[class^=MindstickDialog_Button]:first").focus();r.isIE6&&setTimeout(f,500)},f=function(){var t=n(window).scrollTop(),i=n(window).scrollLeft();r.settings.modal&&r.overlay.css({top:t,left:i});r.dialog.css({left:r.dialog_left+i,top:r.dialog_top+t})},e=function(){switch(r.settings.type){case"confirmation":case"error":case"information":case"question":case"warning":return r.settings.type.charAt(0).toUpperCase()+r.settings.type.slice(1).toLowerCase();default:return!1}},o=function(n){return n.which==27&&r.close(),!0},s=function(){f()};return r.init()}})(jQuery)